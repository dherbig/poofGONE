This is code from maftoun95, which I (dherbig) am annotating for clarity.
